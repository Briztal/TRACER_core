//
// Created by root on 6/27/18.
//

#ifndef TRACER_JERK_H
#define TRACER_JERK_H

#include <stdint.h>

#include "movement.h"
#include "trajectory.h"

/*
 * The jerk data struct;
 *
 * To monitor the jerk between trajectories, we must know for each axis :
 * 	- whether or not the axis comprises a jerk point at the trajectory's end;
 * 	- the trajectory's length;
 * 	- the deceleration distance at the jerk point's maximal acceptable speed, called jerk offset;
 */

typedef struct {

	//A signature, determining which axis must monitor jerk on the trajectory's end point; Can be modified;
	sig_t jerk_flags;

	//The distance of the movement; Set once;
	uint32_t *trajectory_distances;

	//The jerk offsets (deceleration distance to limit speed) at the end point; Set once;
	uint32_t *jerk_offsets;

} jerk_data_t;


//Initialise the jerk structure in the trajectory;
void jerk_init(jerk_data_t *jerk_data, const geometric_base_t *geometric_base, float initial_increment, bool affine_curve);

//Release jerk data;
void jerk_delete(jerk_data_t *jerk_data);

//Determine a movement's distance
void jerk_determine_distances(const geometric_base_t *geometric_base, float initial_increment, uint32_t *distances,
							  bool optimisation);


//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????
//TODO IN INIT ???????????????????



#endif //TRACER_JERK_H
